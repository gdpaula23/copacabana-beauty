<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Basket | Copacabana Beauty</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">

<style>
:root{
  --olive-900:#2F3A22;
  --olive-800:#3F4D2F;
  --olive-700:#566643;

  --beige:#F4EAD6;
  --beige-80: rgba(244,234,214,.80);
  --beige-40: rgba(244,234,214,.40);
  --beige-22: rgba(244,234,214,.22);
  --beige-14: rgba(244,234,214,.14);
  --beige-10: rgba(244,234,214,.10);

  /* surfaces claras */
  --surface:#F5EFE6;
  --surface-2:#FBF9F4;
  --stroke:#E2D9C7;
  --gold:#C6B48A;

  --shadow: 0 40px 90px rgba(0,0,0,.30);
  --radius-xl: 24px;
  --radius-lg: 18px;
  --max: 1160px;
}

*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}

body{
  font-family:'Montserrat',sans-serif;
  color:var(--beige);
  background:
    radial-gradient(circle at 12% 18%, rgba(244,234,214,.10), transparent 65%),
    radial-gradient(circle at 78% 12%, rgba(244,234,214,.08), transparent 68%),
    radial-gradient(circle at 55% 78%, rgba(244,234,214,.07), transparent 72%),
    linear-gradient(180deg,#4B5A3A 0%, #3F4D2F 45%, #2F3A22 100%);
  overflow-x:hidden;
}

.marble-overlay{
  position:fixed;
  inset:-12%;
  z-index:0;
  pointer-events:none;
  background-image:url("marble.png");
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
  opacity:.11;
  filter: blur(1.2px) saturate(.85) contrast(.95);
  mix-blend-mode: soft-light;
  transform: rotate(0deg) scale(1.12);
}
body > *:not(.marble-overlay){position:relative; z-index:1;}

nav{
  position:fixed;
  top:0; left:0; width:100%;
  padding:18px 40px;
  z-index:50;
  display:flex;
  justify-content:flex-end;
  gap:22px;
  background:transparent;
  transition:background .25s ease, transform .25s ease, border-color .25s ease;
}
nav.is-scrolled{
  background:rgba(0,0,0,.10);
  border-bottom:1px solid rgba(244,234,214,.10);
  backdrop-filter: blur(6px);
}
nav.is-hidden{ transform:translateY(-110%); }

nav a{
  color:rgba(244,234,214,.92);
  text-decoration:none;
  font-size:12px;
  letter-spacing:2px;
  opacity:.95;
}
nav a:hover{opacity:1}
.nav-cta{
  padding:10px 14px;
  border:1px solid rgba(244,234,214,.28);
  border-radius:999px;
  background:rgba(244,234,214,.10);
}

.wrap{max-width:var(--max); margin:0 auto; padding:0 20px;}
.section{padding:120px 0 110px;}

h1{
  font-family:'Cormorant Garamond',serif;
  font-size:48px;
  text-align:center;
  margin-bottom:12px;
  text-shadow:0 18px 40px rgba(0,0,0,.20);
}
.sub{
  text-align:center;
  max-width:760px;
  margin:0 auto 44px;
  opacity:.88;
  line-height:1.9;
  font-size:15px;
}
.title-line{
  width:min(520px, 88%);
  height:1px;
  margin:22px auto 0;
  background:linear-gradient(to right, transparent, rgba(244,234,214,.50), transparent);
}

.layout{
  display:grid;
  grid-template-columns: 1.2fr .8fr;
  gap:18px;
  margin-top:44px;
}

/* PANEL glass */
.panel{
  background:
    linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.02)),
    rgba(244,234,214,.10);
  border:1px solid rgba(244,234,214,.22);
  border-radius:var(--radius-xl);
  box-shadow:0 24px 60px rgba(0,0,0,.18);
  padding:22px;
}

.items{
  display:grid;
  gap:12px;
}

/* ITEM claro */
.item{
  display:grid;
  grid-template-columns: 1fr auto;
  gap:12px;
  padding:16px 16px;
  border-radius:18px;

  background:var(--surface);
  border:1px solid var(--stroke);
  color:var(--olive-900);
  box-shadow: 0 10px 26px rgba(0,0,0,.10);
}

.item-title{
  font-family:'Cormorant Garamond',serif;
  font-size:22px;
  line-height:1.1;
  margin-bottom:6px;
  color:var(--olive-900);
}
.item-meta{
  font-size:12px;
  letter-spacing:2px;
  text-transform:uppercase;
  opacity:.78;
  color:rgba(47,58,34,.70);
}
.item-right{
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:10px;
}

.price{
  font-size:14px;
  opacity:.95;
  color:rgba(47,58,34,.85);
}
.price strong{
  font-size:18px;
  font-weight:600;
  color:var(--olive-900);
}

/* Qty */
.qty{
  display:flex;
  align-items:center;
  gap:8px;
}
.qty button{
  width:34px;
  height:34px;
  border-radius:999px;
  border:1px solid var(--stroke);
  background:var(--surface-2);
  color:var(--olive-900);
  cursor:pointer;
  font-size:16px;
  transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}
.qty button:hover{ transform:translateY(-1px); }
.qty button:focus{
  outline:none;
  border-color:var(--gold);
  box-shadow: 0 0 0 4px rgba(198,180,138,.18);
}
.qty span{
  min-width:24px;
  text-align:center;
  font-size:13px;
  opacity:.9;
  color:rgba(47,58,34,.85);
}

/* Remove */
.remove{
  border:none;
  background:transparent;
  color:rgba(47,58,34,.62);
  font-size:12px;
  letter-spacing:2px;
  text-transform:uppercase;
  cursor:pointer;
  opacity:.95;
}
.remove:hover{opacity:1; color:rgba(47,58,34,.82);}

.empty{
  padding:24px;
  text-align:center;
  opacity:.85;
  line-height:1.9;
}

/* card claro interno do summary */
.summary-card{
  background:var(--surface-2);
  border:1px solid var(--stroke);
  border-radius:18px;
  padding:18px 16px;
  color:var(--olive-900);
  box-shadow: 0 14px 34px rgba(0,0,0,.10);
}

/* Summary rows */
.summary-row{
  display:flex;
  justify-content:space-between;
  gap:12px;
  padding:10px 0;
  opacity:.95;
  font-size:14px;
  color:var(--olive-900);
}
.summary-row + .summary-row{
  border-top:1px solid rgba(47,58,34,.10);
}
.summary-row.total{
  border-top:1px solid rgba(47,58,34,.18);
  margin-top:10px;
  padding-top:14px;
  font-size:16px;
  font-weight:600;
}

/* Actions */
.actions{
  display:grid;
  gap:10px;
  margin-top:16px;
}
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  padding:14px 18px;
  border-radius:999px;
  text-decoration:none;
  font-size:12px;
  letter-spacing:2px;
  text-transform:uppercase;
  transition:transform .2s ease, background .2s ease, border-color .2s ease, filter .2s ease;
}
.btn-primary{
  background:var(--beige);
  color:var(--olive-800);
  border:1px solid rgba(244,234,214,.75);
}
.btn-primary:hover{transform:translateY(-2px); filter:brightness(.98);}

.btn-ghost{
  background:rgba(47,58,34,.06);
  border:1px solid rgba(47,58,34,.18);
  color:rgba(47,58,34,.88);
}
.btn-ghost:hover{transform:translateY(-2px); background:rgba(47,58,34,.08);}

.note{
  margin-top:12px;
  font-size:12px;
  opacity:.72;
  line-height:1.8;
  text-align:center;
  color:rgba(47,58,34,.70);
}

/* FAB (fix para mobile) */
.cart-fab{
  position:fixed !important;
  left:auto !important;
  right:18px !important;
  bottom:18px !important;
  z-index:9999 !important;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.18);
  backdrop-filter:blur(10px);
  padding:12px 14px;
  border-radius:999px;
  color:rgba(244,234,214,.92);
  font-size:12px;
  text-decoration:none;
  display:inline-flex;
  align-items:center;
  gap:8px;
  white-space:nowrap;
  max-width: calc(100vw - 24px);
}
.cart-fab span{
  padding:2px 8px;
  border-radius:999px;
  background:rgba(244,234,214,.16);
}

/* REVEAL */
.reveal{opacity:0; transform: translateY(16px); transition: opacity .6s ease, transform .6s ease;}
.reveal.in{opacity:1; transform:none;}

@media(max-width:1020px){
  nav{ padding:16px 16px; }
  .layout{ grid-template-columns:1fr; }
}
@media(max-width:560px){
  h1{ font-size:42px; }
  .item{ grid-template-columns:1fr; }
  .item-right{ align-items:flex-start; }
}
</style>
</head>

<body>
<div class="marble-overlay" id="marbleOverlay"></div>

<nav id="nav">
  <a href="home.html">HOME</a>
  <a href="services2.html">SERVICES</a>
  <a href="cart.html" class="nav-cta">BASKET</a>
</nav>

<section class="section">
  <div class="wrap">
    <h1 class="reveal">Basket</h1>
    <p class="sub reveal">Review your items and pay a £20 deposit to secure your appointment.</p>
    <div class="title-line reveal"></div>

    <div class="layout">
      <!-- Items -->
      <div class="panel reveal">
        <div id="items" class="items"></div>
        <div id="emptyState" class="empty" style="display:none;">
          Your basket is empty.<br>
          Browse our services and add your favourite rituals.
          <div style="margin-top:16px;">
            <a class="btn btn-primary" href="services2.html">View Services</a>
          </div>
        </div>
      </div>

      <!-- Summary -->
      <div class="panel reveal">
        <div class="summary-card">
          <div class="summary-row">
            <span>Subtotal</span>
            <span id="subtotal">£0</span>
          </div>

          <div class="summary-row">
            <span>Deposit today</span>
            <span id="depositToday">£0</span>
          </div>

          <div class="summary-row">
            <span>Remaining on appointment day</span>
            <span id="remainingDay">£0</span>
          </div>

          <div class="summary-row total">
            <span>Total (full service value)</span>
            <span id="total">£0</span>
          </div>

          <div class="actions">
            <a class="btn btn-ghost" href="services2.html">Continue Shopping</a>
            <a class="btn btn-primary" id="checkoutBtn" href="checkout.html">Pay deposit</a>
          </div>

          <div class="note">
  After paying the deposit, you’ll be redirected to WhatsApp to schedule your appointment.<br>
  <strong>Deposit is non-refundable once your booking is confirmed.</strong>
</div>
        </div>
      </div>
    </div>
  </div>
</section>

<a class="cart-fab" href="cart.html">
  BASKET <span id="cartCount">0</span>
</a>

<script>
/* ===== Nav hide/show ===== */
(() => {
  const nav = document.getElementById("nav");
  let lastY = window.scrollY;
  const TOP = 8;
  const HIDE_AFTER = 90;

  function onScroll(){
    const y = window.scrollY;
    const down = y > lastY;

    if (y > TOP) nav.classList.add("is-scrolled");
    else nav.classList.remove("is-scrolled");

    if (down && y > HIDE_AFTER) nav.classList.add("is-hidden");
    else nav.classList.remove("is-hidden");

    lastY = y;
  }
  window.addEventListener("scroll", onScroll, { passive:true });
  onScroll();
})();

/* ===== Random marble ===== */
(() => {
  const el = document.getElementById("marbleOverlay");
  if (!el) return;
  const deg = (Math.random() * 10) - 5;
  const x = Math.floor(Math.random() * 34) + 33;
  const y = Math.floor(Math.random() * 34) + 33;
  el.style.transform = `rotate(${deg}deg) scale(1.12)`;
  el.style.backgroundPosition = `${x}% ${y}%`;
})();

/* ===== Reveal ===== */
(() => {
  const els = document.querySelectorAll(".reveal");
  const io = new IntersectionObserver((entries) => {
    for (const e of entries){
      if (e.isIntersecting){
        e.target.classList.add("in");
        io.unobserve(e.target);
      }
    }
  }, { threshold: 0.12, rootMargin: "0px 0px -10% 0px" });
  els.forEach(el => io.observe(el));
})();

/* ===== CART LOGIC ===== */
const CART_KEY="cb_cart_v1";
const DEPOSIT_FIXED_GBP = 20;

function loadCart(){
  try{return JSON.parse(localStorage.getItem(CART_KEY))||[]}catch{return[]}
}
function saveCart(cart){
  localStorage.setItem(CART_KEY, JSON.stringify(cart));
}
function cartCount(cart){ return cart.reduce((s,i)=>s+(i.qty||1),0); }

function parseAddFromUrl(){
  const params = new URLSearchParams(window.location.search);
  const add = params.get("add");
  const service = params.get("service");
  const price = params.get("price");

  if(add && service && price){
    const cart = loadCart();
    const p = Number(price) || 0;
    const idx = cart.findIndex(i => i.name === service && Number(i.price) === p);
    if(idx >= 0) cart[idx].qty = (cart[idx].qty || 1) + 1;
    else cart.push({ name: service, price: p, qty: 1 });

    saveCart(cart);
    window.history.replaceState({}, document.title, "cart.html");
  }
}

function money(n){
  const v = Math.max(0, Number(n) || 0);
  return "£" + (Math.round(v * 100) / 100).toFixed(2).replace(".00","");
}

function computeSubtotal(cart){
  return cart.reduce((s,i)=> s + (Number(i.price)||0) * (Number(i.qty)||1), 0);
}

function render(){
  const cart = loadCart();
  document.getElementById("cartCount").innerText = cartCount(cart);

  const itemsEl = document.getElementById("items");
  const emptyEl = document.getElementById("emptyState");
  itemsEl.innerHTML = "";

  if(cart.length === 0){
    emptyEl.style.display = "block";
    document.getElementById("subtotal").innerText = money(0);
    document.getElementById("depositToday").innerText = money(0);
    document.getElementById("remainingDay").innerText = money(0);
    document.getElementById("total").innerText = money(0);
    document.getElementById("checkoutBtn").setAttribute("aria-disabled","true");
    document.getElementById("checkoutBtn").style.opacity = ".6";
    document.getElementById("checkoutBtn").style.pointerEvents = "none";
    return;
  } else {
    emptyEl.style.display = "none";
    document.getElementById("checkoutBtn").removeAttribute("aria-disabled");
    document.getElementById("checkoutBtn").style.opacity = "1";
    document.getElementById("checkoutBtn").style.pointerEvents = "auto";
  }

  cart.forEach((it, idx) => {
    const row = document.createElement("div");
    row.className = "item";
    row.innerHTML = `
      <div>
        <div class="item-title">${it.name}</div>
        <div class="item-meta">Service</div>
      </div>
      <div class="item-right">
        <div class="price"><strong>${money(it.price)}</strong></div>
        <div class="qty">
          <button type="button" aria-label="Decrease">−</button>
          <span>${it.qty || 1}</span>
          <button type="button" aria-label="Increase">+</button>
        </div>
        <button class="remove" type="button">Remove</button>
      </div>
    `;

    const btnMinus = row.querySelectorAll("button")[0];
    const btnPlus  = row.querySelectorAll("button")[1];
    const btnRemove = row.querySelector(".remove");

    btnMinus.onclick = () => {
      const cart2 = loadCart();
      cart2[idx].qty = Math.max(1, (cart2[idx].qty||1) - 1);
      saveCart(cart2);
      render();
    };

    btnPlus.onclick = () => {
      const cart2 = loadCart();
      cart2[idx].qty = (cart2[idx].qty||1) + 1;
      saveCart(cart2);
      render();
    };

    btnRemove.onclick = () => {
      const cart2 = loadCart();
      cart2.splice(idx, 1);
      saveCart(cart2);
      render();
    };

    itemsEl.appendChild(row);
  });

  const subtotal = computeSubtotal(cart);
  const depositToday = Math.min(subtotal, DEPOSIT_FIXED_GBP);
  const remainingDay = Math.max(0, subtotal - depositToday);
  const total = subtotal;

  document.getElementById("subtotal").innerText = money(subtotal);
  document.getElementById("depositToday").innerText = money(depositToday);
  document.getElementById("remainingDay").innerText = money(remainingDay);
  document.getElementById("total").innerText = money(total);
}

parseAddFromUrl();
render();
</script>

</body>
</html>
