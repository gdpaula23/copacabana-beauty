<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Services | Copacabana Beauty</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">

<style>
:root{
  --olive-900:#2F3A22;
  --olive-800:#3F4D2F;
  --olive-700:#566643;

  --beige:#F4EAD6;
  --beige-80: rgba(244,234,214,.80);
  --beige-40: rgba(244,234,214,.40);
  --beige-22: rgba(244,234,214,.22);
  --beige-14: rgba(244,234,214,.14);
  --beige-10: rgba(244,234,214,.10);

  --line: rgba(244,234,214,.28);

  --radius-xl: 24px;
  --radius-lg: 18px;

  --max: 1160px;
  --gap: 18px;
}

/* RESET */
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
html, body{height:100%}

body{
  font-family:'Montserrat',sans-serif;
  color:var(--beige);
  background:#2F3A22;
  overflow-x:hidden;
}

/* BACKGROUND FIXO */
.bg-layer{
  position:fixed;
  inset:0;
  z-index:-2;
  background:
    radial-gradient(circle at 12% 18%, rgba(244,234,214,.10), transparent 65%),
    radial-gradient(circle at 78% 12%, rgba(244,234,214,.08), transparent 68%),
    radial-gradient(circle at 55% 78%, rgba(244,234,214,.07), transparent 72%),
    linear-gradient(180deg,#4B5A3A 0%, #3F4D2F 45%, #2F3A22 100%);
}

/* MARBLE OVERLAY */
.marble-overlay{
  position:fixed;
  inset:-12%;
  z-index:-1;
  pointer-events:none;
  background-image:url("marble.png");
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
  opacity:.11;
  filter: blur(1.2px) saturate(.85) contrast(.95);
  mix-blend-mode: soft-light;
  transform: rotate(0deg) scale(1.12);
}

/* NAV */
nav{
  position:fixed;
  top:0; left:0; width:100%;
  padding:18px 40px;
  z-index:50;
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:22px;
  background:transparent;
  transition:background .25s ease, transform .25s ease, border-color .25s ease;
}
nav.is-scrolled{
  background:rgba(0,0,0,.10);
  border-bottom:1px solid rgba(244,234,214,.10);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}
nav.is-hidden{ transform:translateY(-110%); }
nav a{
  color:rgba(244,234,214,.92);
  text-decoration:none;
  font-size:12px;
  letter-spacing:2px;
  opacity:.95;
}
nav a:hover{opacity:1}
.nav-cta{
  padding:10px 14px;
  border:1px solid rgba(244,234,214,.28);
  border-radius:999px;
  background:rgba(244,234,214,.10);
}

/* LAYOUT */
.wrap{max-width:var(--max); margin:0 auto; padding:0 20px;}
.section{padding:120px 0 100px;}

h1{
  font-family:'Cormorant Garamond',serif;
  font-size:48px;
  text-align:center;
  margin-bottom:12px;
  letter-spacing:.2px;
  text-shadow:0 18px 40px rgba(0,0,0,.20);
}
.sub{
  text-align:center;
  max-width:760px;
  margin:0 auto 44px;
  opacity:.88;
  line-height:1.9;
  font-size:15px;
}
.title-line{
  width:min(520px, 88%);
  height:1px;
  margin:22px auto 0;
  background:linear-gradient(to right, transparent, rgba(244,234,214,.50), transparent);
}

/* ===== T√çTULOS DAS CATEGORIAS ===== */
.cat-title{
  margin-top: 52px;
  text-align:center;
  font-family:'Cormorant Garamond',serif;
  font-size: 30px;
  letter-spacing: .2px;
  text-shadow:0 18px 40px rgba(0,0,0,.18);
}
.cat-line{
  width:min(360px, 84%);
  height:1px;
  margin:14px auto 0;
  background:linear-gradient(to right, transparent, rgba(244,234,214,.45), transparent);
}

/* ===== CARDS (ALINHADO + √öLTIMA LINHA CENTRALIZADA) ===== */
.cards{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap: var(--gap);
  margin-top:34px;
}

/* colunas por se√ß√£o */
.cards.cols-6 .card{
  flex: 0 0 calc((100% - (var(--gap) * 5)) / 6);
  max-width: calc((100% - (var(--gap) * 5)) / 6);
}
.cards.cols-4 .card{
  flex: 0 0 calc((100% - (var(--gap) * 3)) / 4);
  max-width: calc((100% - (var(--gap) * 3)) / 4);
}

/* card base */
.card{
  display:flex;
  flex-direction:column;

  background:
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
    rgba(244,234,214,.10);
  border:1px solid rgba(244,234,214,.20);
  border-radius:var(--radius-xl);
  box-shadow:0 24px 60px rgba(0,0,0,.18);
  overflow:hidden;
  transition:transform .18s ease, background .18s ease;
  will-change:transform;
}
.card:hover{
  transform:translateY(-4px);
  background:rgba(244,234,214,.12);
}

/* corpo flex */
.card-body{
  padding:20px 18px 18px;
  display:flex;
  flex-direction:column;
  flex:1;
}

/* actions */
.card-actions{
  display:flex;
  gap:10px;
  margin-top:auto;
}

.card-actions a,
.card-actions button{
  flex:1;
  display:inline-flex;
  justify-content:center;
  align-items:center;
  padding:12px 10px;
  border-radius:999px;
  text-decoration:none;
  font-size:11px;
  letter-spacing:2px;
  text-transform:uppercase;
  border:1px solid rgba(244,234,214,.28);
  cursor:pointer;
  background:rgba(244,234,214,.10);
  color:rgba(244,234,214,.92);
  transition:transform .18s ease, filter .18s ease;
}
.card-actions a.primary{
  background:var(--beige);
  color:var(--olive-800);
  border:1px solid rgba(244,234,214,.75);
}
.card-actions a:hover,
.card-actions button:hover{ transform:translateY(-2px); filter:brightness(.99); }

/* Buttons generic */
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  padding:14px 18px;
  border-radius:999px;
  text-decoration:none;
  font-size:12px;
  letter-spacing:2px;
  text-transform:uppercase;
  transition:transform .2s ease, filter .2s ease;
  border:none;
  cursor:pointer;
}
.btn-primary{
  background:var(--beige);
  color:var(--olive-800);
  border:1px solid rgba(244,234,214,.75);
}
.btn-primary:hover{transform:translateY(-2px); filter:brightness(.98);}

/* BASKET FAB */
.cart-fab{
  position: fixed !important;
  right: 18px !important;
  bottom: 18px !important;
  z-index: 9999 !important;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(0,0,0,.18);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  padding: 12px 14px;
  border-radius: 999px;
  color: rgba(244,234,214,.92);
  font-size: 12px;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  white-space: nowrap;
}
.cart-fab span{
  margin-left: 6px;
  padding: 2px 8px;
  border-radius: 999px;
  background: rgba(244,234,214,.16);
}
@supports (padding: max(0px)){
  .cart-fab{
    right: max(18px, env(safe-area-inset-right)) !important;
    bottom: max(18px, env(safe-area-inset-bottom)) !important;
  }
}
body{ padding-bottom: 110px; }

/* REVEAL */
.reveal{
  opacity:0;
  transform: translateY(16px);
  transition: opacity .6s ease, transform .6s ease;
}
.reveal.in{opacity:1; transform:none;}

/* MODAL */
body.modal-open{ overflow:hidden; }

.modal-overlay{
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100dvh;
  z-index: 99999;

  display: none;
  align-items: center;
  justify-content: center;

  background: rgba(0,0,0,.65);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);

  padding: 24px;
}

.modal-card{
  position: relative;
  width: min(560px, calc(100vw - 48px));
  border-radius: 22px;
  padding: 28px 26px;

  background:
    linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.02)),
    rgba(244,234,214,.12);

  border: 1px solid rgba(244,234,214,.30);
  box-shadow: 0 40px 120px rgba(0,0,0,.60);

  color: var(--beige);
  text-align: left;
}

.modal-title{
  font-family:'Cormorant Garamond',serif;
  font-size: 28px;
  margin-bottom: 14px;
}

.modal-text{
  font-size: 14px;
  line-height: 1.8;
  opacity: .92;
}
.modal-text p{ margin-bottom: 14px; }

.modal-x{
  position: absolute;
  top: 12px;
  right: 12px;
  width: 40px;
  height: 40px;

  border-radius: 999px;
  border: 1px solid rgba(244,234,214,.22);
  background: rgba(244,234,214,.10);
  color: rgba(244,234,214,.92);

  cursor: pointer;
  display: grid;
  place-items: center;

  font-size: 18px;
  line-height: 1;
}
.modal-x:hover{ filter: brightness(1.08); }

/* RESPONSIVO */
@media(max-width:1200px){
  .cards.cols-6 .card,
  .cards.cols-4 .card{
    flex: 0 0 calc((100% - (var(--gap) * 2)) / 3);
    max-width: calc((100% - (var(--gap) * 2)) / 3);
  }
}
@media(max-width:760px){
  .cards.cols-6 .card,
  .cards.cols-4 .card{
    flex: 0 0 calc((100% - (var(--gap) * 1)) / 2);
    max-width: calc((100% - (var(--gap) * 1)) / 2);
  }
}
@media(max-width:560px){
  nav{ padding:12px 14px; gap:16px; }
  nav a{ font-size:11px; letter-spacing:1.6px; }
  .nav-cta{ padding:9px 12px; }

  .wrap{ padding:0 16px; }
  .section{ padding:95px 0 70px; }

  h1{ font-size:36px; line-height:1.12; }
  .sub{ font-size:14px; line-height:1.75; margin:0 auto 30px; padding:0 6px; }
  .title-line{ margin:18px auto 0; }

  .cards.cols-6 .card,
  .cards.cols-4 .card{ flex:0 0 100%; max-width:100%; }
}

/* ====== ‚úÖ NEW PREMIUM CARD LAYOUT OVERRIDES ====== */
.card{ text-align:left; }

.card-body{
  display:flex;
  flex-direction:column;
  height:100%;
}

/* 1) trava o topo (t√≠tulo + dura√ß√£o) */
.card-header{
  min-height: 86px; /* ajuste fino: 78‚Äì96 dependendo do seu gosto */
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
}

/* opcional: limita t√≠tulo a 2 linhas para n√£o estourar */
.card-header h3{
  display:-webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2; /* mostra at√© 2 linhas */
  overflow:hidden;
}

/* 2) imagem sempre com mesma altura (j√° ajuda MUITO) */
.card-img{
  height:190px; /* pode ser 180/200, mas fixa */
}

/* 3) trava a √°rea do pre√ßo */
.card .price{
  min-height: 34px;
  display:flex;
  align-items:flex-end;
}

/* 4) bot√µes sempre colados no final e alinhados */
.card-actions{
  margin-top:auto;
  padding-top:14px;
}

/* ===== IMAGE GRADIENT OVERLAY (PREMIUM LOOK) ===== */

.card-image-wrap{
  position: relative;
  border-radius:16px;
  overflow:hidden;
  box-shadow:0 14px 30px rgba(0,0,0,.28);
  background: rgba(0,0,0,.18);
}

/* Headspa: formato mais vertical (fica igual teu print bonito) */
.card.headspa .card-image-wrap{
  aspect-ratio: 4 / 5;
}

/* Lashes: formato mais horizontal (olho n√£o corta estranho) */
.card.lashes .card-image-wrap{
  aspect-ratio: 4 / 3;
}

/* imagem ocupa o container certinho */
.card-img{
  width:100%;
  height:100%;
  object-fit: cover;
  display:block;
  transform: none;
  transition: transform .45s ease;
}

/* hover suave */
.card:hover .card-img{
  transform: scale(1.03);
}

/* remove qualquer height fixa antiga */
.card-img{ height:100% !important; }

/* stronger overlay for headspa */
.card.headspa .card-image-wrap::after{
  background:
    linear-gradient(
      to bottom,
      rgba(0,0,0,.05) 0%,
      rgba(0,0,0,.18) 45%,
      rgba(0,0,0,.45) 100%
    );
}


</style>
</head>

<body>

<!-- fixed background layers -->
<div class="bg-layer"></div>
<div class="marble-overlay" id="marbleOverlay"></div>

<!-- IMPORTANT INFO MODAL -->
<div class="modal-overlay" id="infoOverlay" aria-hidden="true">
  <div class="modal-card" role="dialog" aria-modal="true" aria-label="Important Information">
    <button class="modal-x" id="infoX" type="button" aria-label="Close">‚úï</button>

    <div class="modal-title">‚ö†Ô∏è Important Information</div>

    <div class="modal-text">
      <p><b>Copacabana Beauty is a women-only wellness space.</b><br>
      Men are only accepted when attending as part of the <b>Duo Brazilian Experience</b>.</p>

      <p>Our treatments are designed for <b>relaxation and wellbeing only</b>.<br>
      We do not offer medical treatments or treatments for scalp conditions.</p>

      <p>Treatments are <b>not suitable during pregnancy</b>, for clients with scalp conditions, or for clients with
      <b>hair extensions, braids, weave or dreadlocks</b>.</p>

      <p><b>Hair longer than 60cm</b> is subject to a <b>¬£10 additional charge</b>.</p>
    </div>

    <button class="btn btn-primary" id="infoClose" type="button">I Understand</button>
  </div>
</div>

<!-- DETAILS MODAL -->
<div class="modal-overlay" id="detailsOverlay" aria-hidden="true">
  <div class="modal-card" role="dialog" aria-modal="true" aria-label="Service Details">
    <button class="modal-x" id="detailsX" type="button" aria-label="Close">‚úï</button>

    <div class="modal-title" id="detailsTitle">Details</div>
    <div class="modal-text" id="detailsDesc"></div>

    <div style="display:flex; gap:12px; margin-top:14px; flex-wrap:wrap;">
      <a class="btn btn-primary" id="detailsAdd" href="#">ADD TO BASKET</a>
      <button class="btn" id="detailsClose" type="button"
        style="border:1px solid rgba(244,234,214,.28); background:rgba(244,234,214,.10); color:rgba(244,234,214,.92);">
        CLOSE
      </button>
    </div>
  </div>
</div>

<nav id="nav">
  <a href="home.html">HOME</a>
  <a href="services2.html">SERVICES</a>
  <a href="cart.html" class="nav-cta">BASKET</a>
</nav>

<section class="section">
  <div class="wrap">
    <h1 class="reveal">Services</h1>
    <p class="sub reveal">Choose your ritual and add it to your basket. You can select more than one service.</p>
    <div class="title-line reveal"></div>

    <!-- ‚úÖ CATEGORIA 1 -->
    <div class="cat-title reveal">Headspa / Massage</div>
    <div class="cat-line reveal"></div>
    <div class="cards cols-6" id="cardsHeadspa"></div>

    <!-- ‚úÖ CATEGORIA 2 -->
    <div class="cat-title reveal">Lashes</div>
    <div class="cat-line reveal"></div>
    <div class="cards cols-4" id="cardsLashes"></div>
  </div>
</section>

<a class="cart-fab" href="cart.html">
  BASKET <span id="cartCount">0</span>
</a>

<script>
/* ====== DADOS DOS SERVI√áOS (AGORA COM category) ====== */
const SERVICES = [
  // ===== Headspa / Massage (6) =====
  { id: 1, category:"headspa", title: "üåä Ocean", duration: "1h", priceLabel: "¬£80", priceValue: 80, cartServiceName: "Ocean", img: "images/ocean.jpg",
    desc: `A gentle introduction to the Brazilian Head Spa experience.

This calming ritual includes scalp relaxation, hair drying and a soothing neck massage, designed to release tension and quiet the mind. A perfect choice for those seeking a peaceful escape from daily stress.

Includes:
	‚Ä¢	Brazilian Head Spa
	‚Ä¢	Relaxing neck massage
	‚Ä¢	Hair drying` },

  { id: 2, category:"headspa", title: "üå¥ Tropical", duration: "1h 30", priceLabel: "¬£120", priceValue: 120, cartServiceName: "Tropical", img: "images/tropical.jpg",
    desc: `A deeper Brazilian Head Spa ritual, enhanced with our signature deep hair hydration inspired by Brazilian hair care traditions.

Includes:
	‚Ä¢	Brazilian Head Spa
	‚Ä¢	Relaxing neck massage
	‚Ä¢	Deep Brazilian hair hydration
	‚Ä¢	Hair drying.` },

  { id: 3, category:"headspa", title: "üåø Amazonian Experience", duration: "2h", priceLabel: "¬£160", priceValue: 160, cartServiceName: "Amazonian Experience", img: "images/ocean.jpg",
    desc: `Our most complete Brazilian wellness journey.

A full ritual designed to care for your scalp, hair, face and feet while deeply relaxing your body. This immersive experience combines Brazilian Head Spa techniques with steam therapy, detox rituals, facial cleansing and a nourishing foot treatment.

Includes:
	‚Ä¢	Brazilian Head Spa detox 
	‚Ä¢	Steam session
	‚Ä¢	Deep Brazilian hair hydration
	‚Ä¢	Relaxing neck massage
	‚Ä¢	Mini facial cleansing
	‚Ä¢	Foot scrub and foot hydration
	‚Ä¢	Relaxing foot massage
	‚Ä¢	Hair drying

Created for women who want to fully disconnect and restore.` },

  { id: 4, category:"headspa", title: "‚ú® Brazilian Signature Experience", duration: "1h 15", priceLabel: "¬£149", priceValue: 149, cartServiceName: "Brazilian Signature Experience", img: "images/ocean.jpg",
    desc: `A signature Brazilian ritual combining full body relaxation with Brazilian Head Spa techniques, created to calm your body and quiet your mind.

This exclusive experience blends Brazilian touch with sensory care, offering a moment that feels personal, intentional and deeply restorative.

Includes:
	‚Ä¢	45 minutes Brazilian Relaxing Body Massage
	‚Ä¢	30 minutes Brazilian Head Spa
	‚Ä¢	Hair drying
	‚Ä¢	Deep hair hydration
	‚Ä¢	Foot massage , scrub and foot hydration
	

Designed for women who seek more than just a treatment ‚Äî a true Brazilian wellness experience.` },

  { id: 5, category:"headspa", title: "Duo Copacabana", duration: "1h 15", priceLabel: "¬£170 (For Two)", priceValue: 170, cartServiceName: "Duo Copacabana (For Two)", img: "images/ocean.jpg",
    desc: `A shared Brazilian Head Spa experience for two people.

Perfect for couples or close companions, this session includes the Ocean Therapy ritual for both guests, allowing you to relax together in a calm and intimate setting.

Includes (per person):
	‚Ä¢	Brazilian Head Spa
	‚Ä¢	Relaxing neck massage
       ‚Ä¢	Hair drying
       ‚Ä¢ Mini facial 

Please note: Men are only accepted as part of this Duo Experience.` },

  { id: 6, category:"headspa", title: "‚ú® Brazilian Relaxing Body Massage", duration: "50m", priceLabel: "¬£50", priceValue: 50, cartServiceName: "Scalp Detox Therapy", img: "images/relaxing.jpg",
    desc: `A calming Brazilian massage experience designed to release tension, slow your breathing and bring your body back into balance.

Using gentle, intuitive Brazilian techniques, this relaxing body massage focuses on stress relief and deep relaxation, helping you disconnect from daily pressure and reconnect with yourself.

Perfect as a standalone treatment or combined with our Brazilian Head Spa for a complete wellness ritual.

Includes:
	‚Ä¢	50 minutes Brazilian Relaxing Body Massage

Created for women who need a moment of calm, presence and care.` },

  // ===== Lashes (4) =====
  { id: 7, category:"lashes", title: "Lash lift + Tint", duration: "2h", priceLabel: "¬£50", priceValue: 50, cartServiceName: "Lash lift + Tint", img: "images/llt.jpg",
    desc: `A lash lift with tint to enhance length and definition.
Perfect for a natural, effortless look.` },

  { id: 8, category:"lashes", title: "Brazilian volume", duration: "2h", priceLabel: "¬£60", priceValue: 60, cartServiceName: "Brazilian volume", img: "images/brazilian.jpg",
    desc: `Fuller, fluffier lashes with a bold but elegant finish.
Ideal for clients who want noticeable volume.` },

  { id: 9, category:"lashes", title: "Classic", duration: "2h", priceLabel: "¬£60", priceValue: 60, cartServiceName: "Classic", img: "images/classic.jpg",
    desc: `Classic lash extensions for a clean, timeless look.
Great for everyday definition.` },

  { id: 10, category:"lashes", title: "Natural", duration: "2h", priceLabel: "¬£60", priceValue: 60, cartServiceName: "Natural", img: "images/natural.jpg",
    desc: `Hybrid set combining classic + volume for a textured, balanced look.
(Placeholder ‚Äî you can edit everything.)` },
];

const headspaEl = document.getElementById("cardsHeadspa");
const lashesEl  = document.getElementById("cardsLashes");

function addToBasketLink(s){
  const service = encodeURIComponent(s.cartServiceName);
  const price = encodeURIComponent(s.priceValue);
  return `cart.html?add=1&service=${service}&price=${price}`;
}

/* ‚úÖ CARD HTML (title on top, image below) */
function cardHTML(s){
  return `
    <div class="card reveal ${s.category}" data-id="${s.id}">
      <div class="card-body">

        <div class="card-header">
          <h3>${s.title}</h3>
          <div class="meta">DURATION ¬∑ ${s.duration}</div>
        </div>

        <div class="card-image-wrap">
          <img class="card-img" src="${s.img}" alt="${s.title}">
        </div>

        <div class="price"><strong>${s.priceLabel}</strong></div>

        <div class="card-actions">
          <button type="button" class="js-details">DETAILS</button>
          <a class="primary" href="${addToBasketLink(s)}">ADD</a>
        </div>

      </div>
    </div>
  `;
}

/* ‚úÖ Render separado por categoria */
headspaEl.innerHTML = SERVICES.filter(s => s.category === "headspa").map(cardHTML).join("");
lashesEl.innerHTML  = SERVICES.filter(s => s.category === "lashes").map(cardHTML).join("");

/* NAV hide/show */
(() => {
  const nav = document.getElementById("nav");
  let lastY = window.scrollY;
  const TOP = 8;
  const HIDE_AFTER = 90;

  function onScroll(){
    const y = window.scrollY;
    const down = y > lastY;

    if (y > TOP) nav.classList.add("is-scrolled");
    else nav.classList.remove("is-scrolled");

    if (down && y > HIDE_AFTER) nav.classList.add("is-hidden");
    else nav.classList.remove("is-hidden");

    lastY = y;
  }
  window.addEventListener("scroll", onScroll, { passive:true });
  onScroll();
})();

/* Scroll reveal */
(() => {
  const els = document.querySelectorAll(".reveal");
  const io = new IntersectionObserver((entries) => {
    for (const e of entries){
      if (e.isIntersecting){
        e.target.classList.add("in");
        io.unobserve(e.target);
      }
    }
  }, { threshold: 0.12, rootMargin: "0px 0px -10% 0px" });
  els.forEach(el => io.observe(el));
})();

/* Random marble */
(() => {
  const el = document.getElementById("marbleOverlay");
  if (!el) return;

  const deg = (Math.random() * 10) - 5;
  const x = Math.floor(Math.random() * 34) + 33;
  const y = Math.floor(Math.random() * 34) + 33;

  el.style.transform = `rotate(${deg}deg) scale(1.12)`;
  el.style.backgroundPosition = `${x}% ${y}%`;
})();

/* Basket badge */
const CART_KEY="cb_cart_v1";
function loadCart(){
  try{return JSON.parse(localStorage.getItem(CART_KEY))||[]}catch{return[]}
}
function count(cart){return cart.reduce((s,i)=>s+(i.qty||1),0)}
document.getElementById("cartCount").innerText = String(count(loadCart()));

/* ===== MODAL HELPERS ===== */
function openOverlay(overlay){
  overlay.style.display = "flex";
  overlay.setAttribute("aria-hidden", "false");
  document.body.classList.add("modal-open");
}
function closeOverlay(overlay){
  overlay.style.display = "none";
  overlay.setAttribute("aria-hidden", "true");
  document.body.classList.remove("modal-open");
}

/* ===== IMPORTANT INFO (1x por sess√£o) ===== */
(function(){
  const overlay = document.getElementById("infoOverlay");
  const okBtn = document.getElementById("infoClose");
  const xBtn = document.getElementById("infoX");
  if (!overlay || !okBtn || !xBtn) return;

  function close(){
    closeOverlay(overlay);
    sessionStorage.setItem("cb_info_seen", "yes");
  }

  if (!sessionStorage.getItem("cb_info_seen")) openOverlay(overlay);

  okBtn.addEventListener("click", close);
  xBtn.addEventListener("click", close);
  overlay.addEventListener("click", (e) => { if (e.target === overlay) close(); });
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && overlay.style.display !== "none") close();
  });
})();

/* ===== DETAILS MODAL ===== */
(function(){
  const overlay = document.getElementById("detailsOverlay");
  const titleEl = document.getElementById("detailsTitle");
  const descEl  = document.getElementById("detailsDesc");
  const addEl   = document.getElementById("detailsAdd");
  const closeBtn= document.getElementById("detailsClose");
  const xBtn    = document.getElementById("detailsX");
  if (!overlay || !titleEl || !descEl || !addEl || !closeBtn || !xBtn) return;

  function close(){
    closeOverlay(overlay);
  }

  function openDetails(service){
    titleEl.textContent = service.title;

    const text = (service.desc || "").trim();
    const paragraphs = text.split(/\n+/).map(t => t.trim()).filter(Boolean);
    descEl.innerHTML = paragraphs.map(p => `<p>${p}</p>`).join("");

    addEl.href = addToBasketLink(service);
    openOverlay(overlay);
  }

  document.addEventListener("click", (e) => {
    const btn = e.target.closest(".js-details");
    if (!btn) return;

    const card = btn.closest(".card");
    const id = Number(card?.dataset?.id);
    const service = SERVICES.find(s => s.id === id);
    if (service) openDetails(service);
  });

  closeBtn.addEventListener("click", close);
  xBtn.addEventListener("click", close);
  overlay.addEventListener("click", (e) => { if (e.target === overlay) close(); });
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && overlay.style.display !== "none") close();
  });
})();
</script>

</body>
</html>
