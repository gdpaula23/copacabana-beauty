<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Booking confirmed | Copacabana Beauty</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">

<style>
:root{
  --olive-800:#3F4D2F;
  --beige:#F4EAD6;
  --radius-xl: 24px;
  --max: 860px;
}
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:'Montserrat',sans-serif;
  color:var(--beige);
  background:
    radial-gradient(circle at 12% 18%, rgba(244,234,214,.10), transparent 65%),
    radial-gradient(circle at 78% 12%, rgba(244,234,214,.08), transparent 68%),
    radial-gradient(circle at 55% 78%, rgba(244,234,214,.07), transparent 72%),
    linear-gradient(180deg,#4B5A3A 0%, #3F4D2F 45%, #2F3A22 100%);
  padding:120px 16px 90px;
}
.card{
  max-width:var(--max);
  margin:0 auto;
  border-radius:var(--radius-xl);
  border:1px solid rgba(244,234,214,.18);
  background:rgba(244,234,214,.08);
  padding:26px;
  text-align:center;
  box-shadow:0 26px 60px rgba(0,0,0,.16);
}
h1{
  font-family:'Cormorant Garamond',serif;
  font-size:42px;
  margin-bottom:8px;
}
p{opacity:.88; line-height:1.8;}
.kv{
  margin:18px auto 0;
  max-width:520px;
  text-align:left;
  padding:16px;
  border-radius:18px;
  border:1px solid rgba(244,234,214,.18);
  background:rgba(0,0,0,.10);
}
.row{
  display:flex;
  justify-content:space-between;
  gap:12px;
  padding:10px 6px;
  border-bottom:1px solid rgba(244,234,214,.12);
  font-size:14px;
}
.row:last-child{border-bottom:none}
.label{opacity:.75}
.value{font-weight:500}
.btnrow{
  display:flex;
  justify-content:center;
  gap:12px;
  flex-wrap:wrap;
  margin-top:18px;
}
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  padding:14px 18px;
  border-radius:999px;
  text-decoration:none;
  font-size:12px;
  letter-spacing:2px;
  text-transform:uppercase;
  transition:transform .2s ease, filter .2s ease;
  background:var(--beige);
  color:var(--olive-800);
  border:1px solid rgba(244,234,214,.75);
}
.btn.secondary{
  background:transparent;
  color:var(--beige);
  border:1px solid rgba(244,234,214,.35);
}
.btn:hover{transform:translateY(-2px); filter:brightness(.98);}
.small{margin-top:12px;font-size:12px;opacity:.78;line-height:1.7}
</style>
</head>

<body>
  <div class="card">
    <h1>Booking received</h1>
    <p>Thank you — your deposit payment was received. We’ll confirm your booking shortly.</p>

    <div class="kv" id="details" style="display:none;">
      <div class="row"><span class="label">Staff</span><span class="value" id="staff">—</span></div>
      <div class="row"><span class="label">Date</span><span class="value" id="date">—</span></div>
      <div class="row"><span class="label">Time</span><span class="value" id="time">—</span></div>
      <div class="row"><span class="label">Duration</span><span class="value" id="duration">—</span></div>
    </div>

    <div class="btnrow">
      <a class="btn secondary" href="/booking.html">Make another booking</a>
      <a id="waBtn" class="btn" href="#" target="_blank" rel="noopener" style="display:none;">Contact on WhatsApp</a>
    </div>

    <div class="small" id="hint">If you need help, you can contact us on WhatsApp.</div>
  </div>

<script>
  // Booking salvo pelo booking.html
  const BOOKING_KEY = "cb_booking_v1";

  function loadBooking() {
    try { return JSON.parse(localStorage.getItem(BOOKING_KEY) || "null"); }
    catch { return null; }
  }

  function formatDate(yyyyMmDd){
    // Mantém simples (sem libs). Se já vier yyyy-mm-dd, mostramos assim.
    return yyyyMmDd || "—";
  }

  function formatTimeLabel(label, startISO){
    if (label) return label;
    if (!startISO) return "—";
    try{
      const d = new Date(startISO);
      // mostra HH:MM no horário local do navegador
      return d.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
    } catch {
      return "—";
    }
  }

  const booking = loadBooking();

  if (booking) {
    document.getElementById("details").style.display = "block";
    document.getElementById("staff").textContent = booking.staffName || booking.staffKey || "—";
    document.getElementById("date").textContent = formatDate(booking.date);
    document.getElementById("time").textContent = formatTimeLabel(booking.label, booking.startISO);
    document.getElementById("duration").textContent = booking.durationMin ? `${booking.durationMin} min` : "—";
  }

  // WhatsApp opcional (SEM auto redirect)
  const WHATSAPP_NUMBER = "447934424780";
  const waBtn = document.getElementById("waBtn");

  // Mensagem simples usando booking
  const msg = booking
    ? `Hello! I’ve paid the deposit. Booking: ${booking.staffName || booking.staffKey} on ${booking.date} at ${formatTimeLabel(booking.label, booking.startISO)}.`
    : `Hello! I’ve paid the deposit and need help with my booking.`;

  const waUrl = `https://api.whatsapp.com/send/?phone=${WHATSAPP_NUMBER}&text=${encodeURIComponent(msg)}&type=phone_number&app_absent=0`;

  waBtn.href = waUrl;
  waBtn.style.display = "inline-flex";
</script>
</body>
</html>
